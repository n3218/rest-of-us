(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{219:function(e,a,o){"use strict";o.r(a);var t=o(0),l=o.n(t),n=o(14),r=o(2),s=o(6),c=o(3),i=o.n(c),u=o(33),p=o(15);const f=({person:e})=>l.a.createElement(s.b,{to:"/profile/"+e.username,className:"list-group-item list-group-item-action"},l.a.createElement("img",{className:"avatar-small mr-3",src:e.avatar}),l.a.createElement("span",{className:"h5"},e.username));var m=({who:e})=>{const{username:a}=Object(r.g)(),[o,n]=Object(t.useState)(!0),[s,c]=Object(t.useState)([]);return Object(t.useEffect)(()=>{const o=i.a.CancelToken.source();return(async()=>{try{const t=await i.a.get(`/profile/${a}/${e}`,{cancelToken:o.token});c(t.data),n(!1)}catch(e){console.log(e.response.data),console.log("...Or request was cancelled")}})(),()=>{o.cancel("Operation cancelled")}},[a,e]),o?l.a.createElement(p.a,null):l.a.createElement("div",{className:"list-group"},s.map((e,a)=>l.a.createElement(f,{key:a,person:e})))},w=o(12),g=o(13);a.default=()=>{const{username:e}=Object(r.g)(),a=Object(t.useContext)(w.a),[o,c]=Object(g.a)({followActionLoading:!1,startFollowingRequestCount:0,stopFollowingRequestCount:0,profileData:{profileUsername:"...",profileAvatar:"https://gravatar.com/avatar/placeholder?s=128",isFollowing:!1,counts:{postCount:"",followerCount:"",followingCount:""}}});Object(t.useEffect)(()=>{const o=i.a.CancelToken.source();return(async()=>{try{const t=await i.a.post("/profile/"+e,{token:a.user.token},{cancelToken:o.token});c(e=>{e.profileData=t.data})}catch(e){console.log(e.response.data),console.log("...Or request was cancelled")}})(),()=>{o.cancel("Operation cancelled")}},[e]),Object(t.useEffect)(()=>{if(o.startFollowingRequestCount){c(e=>{e.followActionLoading=!0});const e=i.a.CancelToken.source();return(async()=>{try{await i.a.post("/addFollow/"+o.profileData.profileUsername,{token:a.user.token},{cancelToken:e.token});c(e=>{e.profileData.isFollowing=!0,e.profileData.counts.followerCount++,e.followActionLoading=!1})}catch(e){console.log(e.response.data),console.log("...Or request was cancelled")}})(),()=>{e.cancel("Operation cancelled")}}},[o.startFollowingRequestCount]),Object(t.useEffect)(()=>{if(o.stopFollowingRequestCount){c(e=>{e.followActionLoading=!0});const e=i.a.CancelToken.source();return(async()=>{try{await i.a.post("/removeFollow/"+o.profileData.profileUsername,{token:a.user.token},{cancelToken:e.token});c(e=>{e.profileData.isFollowing=!1,e.profileData.counts.followerCount--,e.followActionLoading=!1})}catch(e){console.log(e.response.data),console.log("...Or request was cancelled")}})(),()=>{e.cancel("Operation cancelled")}}},[o.stopFollowingRequestCount]);const{profileData:p}=o;return l.a.createElement(n.a,null,l.a.createElement("h2",null,l.a.createElement("img",{className:"avatar-profile mr-3",src:p.profileAvatar})," ",p.profileUsername,a.loggedIn&&!o.profileData.isFollowing&&a.user.username!=o.profileData.profileUsername&&"..."!=o.profileData.profileUsername&&l.a.createElement("button",{onClick:()=>{c(e=>{e.startFollowingRequestCount++})},disabled:o.followActionLoading,className:"btn btn-primary btn-sm ml-3"},"Follow ",l.a.createElement("i",{className:"fas fa-user-plus"})),a.loggedIn&&o.profileData.isFollowing&&a.user.username!=o.profileData.profileUsername&&"..."!=o.profileData.profileUsername&&l.a.createElement("button",{onClick:()=>{c(e=>{e.stopFollowingRequestCount++})},disabled:o.followActionLoading,className:"btn btn-danger btn-sm ml-3"},"Stop Following ",l.a.createElement("i",{className:"fas fa-user-times"}))),l.a.createElement("div",{className:"profile-nav nav nav-tabs pt-2 mb-4"},l.a.createElement(s.c,{exact:!0,to:"/profile/"+o.profileData.profileUsername,className:"nav-item nav-link"},"Posts: ",p.counts.postCount),l.a.createElement(s.c,{to:`/profile/${o.profileData.profileUsername}/followers`,className:"nav-item nav-link"},"Followers: ",p.counts.followerCount),l.a.createElement(s.c,{to:`/profile/${o.profileData.profileUsername}/following`,className:"nav-item nav-link"},"Following: ",p.counts.followingCount)),l.a.createElement(r.d,null,l.a.createElement(r.b,{exact:!0,path:"/profile/:username"},l.a.createElement(u.b,null)),l.a.createElement(r.b,{path:"/profile/:username/followers"},l.a.createElement(m,{who:"followers"})),l.a.createElement(r.b,{path:"/profile/:username/following"},l.a.createElement(m,{who:"following"}))))}}}]);